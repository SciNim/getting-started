<!DOCTYPE HTML>
<html lang="en-us" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using nimibook -->
        <meta charset="UTF-8">
        <title>ODEs - SciNim Getting Started</title>

        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Tutorials for libraries in SciNim ecosystems">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2280%22>üê≥</text></svg>">
        <link rel="stylesheet" href="../assets/css/variables.css">
        <link rel="stylesheet" href="../assets/css/general.css">
        <link rel="stylesheet" href="../assets/css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../assets/FontAwesome/css/font-awesome.min.css">

        <!-- Highlight.js Stylesheets - I could use nimib native highlight but let's keep it for styling... -->
        <link rel="stylesheet" href="../assets/css/highlight.css">
        <link rel="stylesheet" href="../assets/css/tomorrow-night.css">
        <link rel="stylesheet" href="../assets/css/ayu-highlight.css">

        <!-- Custom theme stylesheets - why the "../"? -->


        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous" onload="renderMathInElement(document.body,{delimiters:[{left: '$$', right: '$$', display: true},{left: '$', right: '$', display: false}]});"></script>
        
        <!-- plausible analytics (new in nimibook) -->
        <script defer data-domain="scinim.github.io/getting-started" src="https://plausible.io/js/plausible.js"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "..//assets";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                                <ol class="chapter">
                <li class="chapter-item expanded ">
                  <a href="../index.html" tabindex="0">
                    <strong aria-hidden="true">1.</strong> Introduction
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../overview/index.html" tabindex="0">
                    <strong aria-hidden="true">2.</strong> Ecosystem overview
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../basics/index.html" tabindex="0">
                    <strong aria-hidden="true">3.</strong> Basic topics
                  </a></li>
                  <li>
                  <ol class="section">
                <li class="chapter-item expanded ">
                  <a href="../basics/common_datatypes.html" tabindex="0">
                    <strong aria-hidden="true">3.1.</strong> Common datatypes
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../basics/data_wrangling.html" tabindex="0">
                    <strong aria-hidden="true">3.2.</strong> Data wrangling with dataframes
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../basics/basic_plotting.html" tabindex="0">
                    <strong aria-hidden="true">3.3.</strong> Plotting
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../basics/units_basics.html" tabindex="0">
                    <strong aria-hidden="true">3.4.</strong> Units
                  </a></li>
                  </ol>
                  </li>
                <li class="chapter-item expanded ">
                  <a href="../numerical_methods/index.html" tabindex="0">
                    <strong aria-hidden="true">4.</strong> Numerical methods
                  </a></li>
                  <li>
                  <ol class="section">
                <li class="chapter-item expanded ">
                  <a href="../numerical_methods/curve_fitting.html" tabindex="0">
                    <strong aria-hidden="true">4.1.</strong> Curve fitting
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../numerical_methods/integration1d.html" tabindex="0">
                    <strong aria-hidden="true">4.2.</strong> Integration (1D)
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../numerical_methods/ode.html" class="active" tabindex="0">
                    <strong aria-hidden="true">4.3.</strong> ODEs
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../numerical_methods/optimization.html" tabindex="0">
                    <strong aria-hidden="true">4.4.</strong> Optimization
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../numerical_methods/interpolation.html" tabindex="0">
                    <strong aria-hidden="true">4.5.</strong> Interpolation
                  </a></li>
                  </ol>
                  </li>
                <li class="chapter-item expanded ">
                  <a href="../data_viz/index.html" tabindex="0">
                    <strong aria-hidden="true">5.</strong> Data visualization
                  </a></li>
                  <li>
                  <ol class="section">
                <li class="chapter-item expanded ">
                  <a href="../data_viz/plotting_data.html" tabindex="0">
                    <strong aria-hidden="true">5.1.</strong> Plotting data
                  </a></li>
                  </ol>
                  </li>
                <li class="chapter-item expanded ">
                  <a href="../external_language_integration/index.html" tabindex="0">
                    <strong aria-hidden="true">6.</strong> Interfacing with other language
                  </a></li>
                  <li>
                  <ol class="section">
                <li class="chapter-item expanded ">
                  <a href="../external_language_integration/nim_with_py.html" tabindex="0">
                    <strong aria-hidden="true">6.1.</strong> Nimpy - The Nim Python bridge
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../external_language_integration/julia/basics.html" tabindex="0">
                    <strong aria-hidden="true">6.2.</strong> Nimjl - The Nim Julia bridge
                  </a></li>
                  <li>
                  <ol class="section">
                <li class="chapter-item expanded ">
                  <a href="../external_language_integration/julia/nimjl_conversions.html" tabindex="0">
                    <strong aria-hidden="true">6.2.1.</strong> Advanced types
                  </a></li>
                <li class="chapter-item expanded ">
                  <a href="../external_language_integration/julia/nimjl_arrays.html" tabindex="0">
                    <strong aria-hidden="true">6.2.2.</strong> Julia Arrays from Nim
                  </a></li>
                  </ol>
                  </li>
                <li class="chapter-item expanded ">
                  <a href="../external_language_integration/nim_with_R.html" tabindex="0">
                    <strong aria-hidden="true">6.3.</strong> Interfacing with R
                  </a></li>
                </ol>
<!-- I could use also an unescaped context value -->
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">SciNim Getting Started</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/SciNim/getting-started" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>


                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1>Solve ordinary differential equations in Nim</h1>
<p>Ordinary differential equations (ODEs) describe so many aspects of nature, but many of them do not have
simple solutions you can solve using pen and paper. That is where numerical solutions come in. They allow
us to solve these equations approximately. We will use <a href="https://github.com/SciNim/numericalnim">numericalnim</a>
for this. The required imports are:</p>
                        <pre><code class="nim hljs"><span class="hljs-keyword">import</span> ggplotnim, numericalnim, benchy, std / [math, sequtils]</code></pre>
                        <p>We will use an ODE with a known solution to be able to compare our numerical solution with
the analytical one. The ODE we will solve is:
$$y' = y (1 - y)$$
$$y(0) = 0.1$$
which has the solution of a sigmoid:
$$y(t) = \frac{1}{1 + 9 e^{-t}}$$</p>
<p>This equation can for example describe a system which grows exponentially at the beginning, but due to
limited amounts of resources the growth stops and it reaches an equilibrium. The solution looks like this:</p>
                        <figure>
<img src="../images/sigmoid_solution.png" alt="">
<figcaption></figcaption>
</figure>
                        <h2>Let's code</h2>
<p>Let us create the function for evaluating the derivative $y'(t, y)$:</p>
                        <pre><code class="nim hljs"><span class="hljs-keyword">proc</span> exact(t: <span class="hljs-built_in">float</span>): <span class="hljs-built_in">float</span> =
  <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + <span class="hljs-number">9</span>*exp(-t))

<span class="hljs-keyword">proc</span> dy(t: <span class="hljs-built_in">float</span>, y: <span class="hljs-built_in">float</span>, ctx: <span class="hljs-type">NumContext</span>[<span class="hljs-built_in">float</span>, <span class="hljs-built_in">float</span>]): <span class="hljs-built_in">float</span> =
  y * (<span class="hljs-number">1</span> - y)</code></pre>
                        <p><code>numericalnim</code> expects a function of the form <code>proc(t: float, y: T, ctx: NumContext[T, float]): T</code>,
where <code>T</code> is the type of the function value (can be <code>Tensor[float]</code> if you have a vector-valued function),
and <code>ctx</code> is a context variable that allows you to pass parameters or save information between function calls.
Now we need to define a few parameters before we can do the actual solving:</p>
                        <pre><code class="nim hljs"><span class="hljs-keyword">let</span> t0 = <span class="hljs-number">0.0</span>
<span class="hljs-keyword">let</span> tEnd = <span class="hljs-number">10.0</span>
<span class="hljs-keyword">let</span> y0 = <span class="hljs-number">0.1</span> <span class="hljs-comment"># initial condition</span>
<span class="hljs-keyword">let</span> tspan = linspace(t0, tEnd, <span class="hljs-number">20</span>)
<span class="hljs-keyword">let</span> odeOptions = newODEoptions(tStart = t0)</code></pre>
                        <p>Here we define the starting time (<code>t0</code>), the value of the function at that time (<code>y0</code>), the time points we want to get
the solution at (<code>tspan</code>) and the options we want the solver to use (<code>odeOptions</code>). There are more options you can pass,
for example the timestep <code>dt</code> used for fixed step-size methods and <code>dtMax</code> and <code>dtMin</code> used by adaptive methods.
The only thing left is to choose which method we want to use. The fixed step-size methods are:</p>
                        <ul>
<li><a href="https://en.wikipedia.org/wiki/Heun%27s_method">heun2</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Ralston%27s_method">ralston2</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Kutta%27s_third-order_method">kutta3</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Heun%27s_third-order_method">heun3</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Ralston%27s_third-order_method">ralston3</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Third-order_Strong_Stability_Preserving_Runge-Kutta_(SSPRK3)">ssprk3</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Ralston%27s_fourth-order_method">ralston4</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#3/8-rule_fourth-order_method">kutta4</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Classic_fourth-order_method">rk4</a></li>
</ul>
                        <p>And the adaptive methods are:</p>
                        <ul>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Heun%E2%80%93Euler">rk21</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Bogacki%E2%80%93Shampine">bs32</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods#Dormand%E2%80%93Prince">dopri54</a></li>
<li><a href="http://users.uoa.gr/~tsitourasc/RK54_new_v2.pdf">tsit54</a></li>
<li><a href="https://www.sfu.ca/~jverner/">vern65</a></li>
</ul>
                        <p>That is a lot to choose from, but its hard to go wrong with any of the adaptive methods <code>dopri54, tsit54 &amp; vern65</code>. So let's use <code>tsit54</code>!</p>
                        <pre><code class="nim hljs"><span class="hljs-keyword">let</span> (t, y) = solveOde(dy, y0, tspan, odeOptions, integrator=<span class="hljs-string">&quot;tsit54&quot;</span>)
<span class="hljs-keyword">let</span> error = abs(y[^<span class="hljs-number">1</span>] - exact(t[^<span class="hljs-number">1</span>]))
<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error: &quot;</span>, error</code></pre><pre class="nb-output"><samp>Error: 3.33066907387547e-16</samp></pre>
                        <p>We call <code>solveOde</code> with our parameters and it returns one <code>seq</code> with our time points and one with our solution at those points.
We can check the error at the last point and we see that it is around <code>3e-16</code>. Let's plot this solution:</p>
                        <pre><code class="nim hljs"><span class="hljs-keyword">let</span> yExact = t.mapIt(exact(it))
<span class="hljs-keyword">var</span> df = toDf(t, y, yExact)
df = df.gather([<span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;yExact&quot;</span>], key=<span class="hljs-string">&quot;Class&quot;</span>, value=<span class="hljs-string">&quot;y&quot;</span>)
ggplot(df, aes(<span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>, color=<span class="hljs-string">&quot;Class&quot;</span>)) +
  geom_line() +
  ggtitle(<span class="hljs-string">&quot;Tsit54 Solution&quot;</span>) +
  ggsave(<span class="hljs-string">&quot;images/tsit54_solution.png&quot;</span>)</code></pre>
                        <figure>
<img src="../images/tsit54_solution.png" alt="">
<figcaption></figcaption>
</figure>
                        <p>As we can see, the graphs are very similar so it seems to work :D.</p>
<p>Now you might be curios how well a few of the other methods performed, and here you have it:</p>
                        <ul>
<li>heun2: 4.961920e-12</li>
</ul>
                        <ul>
<li>rk4: 2.442491e-15</li>
</ul>
                        <ul>
<li>rk21: 4.990390e-08</li>
</ul>
                        <ul>
<li>tsit54: 3.330669e-16</li>
</ul>
                        <p>We can see that the higher-order methods has a lower error compared to the lower-order ones. Tweaking the
<code>odeOptions</code> would probably get them on-par with the others. There is one parameter we haven't talked about though,
the execution time. Let's look at that and see if it bring any further insights:</p>
                        <pre><code class="nim hljs"></code></pre><pre class="nb-output"><samp>   min time    avg time  std dv   runs name
   7.775 ms    7.922 ms  ¬±0.085   x631 heun2
  11.020 ms   11.164 ms  ¬±0.091   x448 rk4
   0.283 ms    0.322 ms  ¬±0.080  x1000 rk21
   0.346 ms    0.384 ms  ¬±0.080  x1000 tsit54</samp></pre>
                        <p>As we can see, the adaptive methods are orders of magnitude faster while achieving roughly the same errors.
This is because they take fewer and longer steps when the function is flatter and only decrease the
step-size when the function is changing more rapidly.</p>
<h2>Vector-valued functions</h2>
<p>Now let us look at another example which is a simplified version of what you might get from discretizing a PDE, multiple function values.
The equation in question is
$$y'' = -y$$
$$y(0) = 0$$
$$y'(0) = 1$$
This has the simple solution
$$y(t) = \sin(t)$$
but it is not on the form <code>y' = ...</code> that <code>numericalnim</code> wants, so we have to rewrite it.
We introduce a new variable $z = y'$ and then we can rewrite the equation like:
$$y'' = (y')' = z' = -y$$
This gives us a system of ODEs:
$$y' = z$$
$$z' = -y$$
$$y(0) = 0$$
$$z(0) = y'(0) = 1$$</p>
<p>This can be written in vector-form to simplify it:
$$\mathbf{v} = [y, z]^T$$
$$\mathbf{v}' = [z, -y]^T$$
$$\mathbf{v}(0) = [0, 1]^T$$</p>
<p>Now we can write a function which takes as input a $\mathbf{v}$ and returns the derivative of them.
This function can be represented as a matrix multiplication, $\mathbf{v}' = A\mathbf{v}$, with a matrix $A$:
$$A = \begin{bmatrix}0 &amp; 1\\-1 &amp; 0\end{bmatrix}$$</p>
<p>Let us code this function but let us also take this opportunity to explore the <code>NumContext</code> to pass in <code>A</code>.</p>
                        <pre><code class="nim hljs"><span class="hljs-keyword">proc</span> dv(t: <span class="hljs-built_in">float</span>, y: <span class="hljs-type">Tensor</span>[<span class="hljs-built_in">float</span>], ctx: <span class="hljs-type">NumContext</span>[<span class="hljs-type">Tensor</span>[<span class="hljs-built_in">float</span>], <span class="hljs-built_in">float</span>]): <span class="hljs-type">Tensor</span>[<span class="hljs-built_in">float</span>] =
  ctx.tValues[<span class="hljs-string">&quot;A&quot;</span>] * y</code></pre>
                        <p><code>NumContext</code> consists of two tables, <code>ctx.fValues</code> which can contain <code>float</code>s and <code>ctx.tValues</code> which in this case can hold
<code>Tensor[float]</code>. So we access <code>A</code> which we will insert when creating the context variable:</p>
                        <pre><code class="nim hljs"><span class="hljs-keyword">var</span> ctx = newNumContext[<span class="hljs-type">Tensor</span>[<span class="hljs-built_in">float</span>], <span class="hljs-built_in">float</span>]()
ctx.tValues[<span class="hljs-string">&quot;A&quot;</span>] = @[@[<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>], @[-<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>]].toTensor</code></pre>
                        <p>Now we are ready to setup and run the simulation as we did previously:</p>
                        <pre><code class="nim hljs"><span class="hljs-keyword">let</span> t0 = <span class="hljs-number">0.0</span>
<span class="hljs-keyword">let</span> tEnd = <span class="hljs-number">20.0</span>
<span class="hljs-keyword">let</span> y0 = @[@[<span class="hljs-number">0.0</span>], @[<span class="hljs-number">1.0</span>]].toTensor <span class="hljs-comment"># initial condition</span>
<span class="hljs-keyword">let</span> tspan = linspace(t0, tEnd, <span class="hljs-number">50</span>)
<span class="hljs-keyword">let</span> odeOptions = newODEoptions(tStart = t0)

<span class="hljs-keyword">let</span> (t, y) = solveOde(dv, y0, tspan, odeOptions, ctx=ctx, integrator=<span class="hljs-string">&quot;tsit54&quot;</span>)
<span class="hljs-keyword">let</span> yEnd = y[^<span class="hljs-number">1</span>][<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
<span class="hljs-keyword">let</span> error = abs(yEnd - sin(tEnd))
<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error: &quot;</span>, error</code></pre><pre class="nb-output"><samp>Error: 2.114974861910923e-13</samp></pre>
                        <p>The error is nice and low. The error for the other methods are along with the timings:</p>
                        <ul>
<li>heun2: 1.361859e-08</li>
</ul>
                        <ul>
<li>rk4: 1.357736e-11</li>
</ul>
                        <ul>
<li>rk21: 1.381992e-04</li>
</ul>
                        <ul>
<li>tsit54: 2.114975e-13</li>
</ul>
                        <pre><code class="nim hljs"></code></pre><pre class="nb-output"><samp>4513.710 ms 4523.889 ms ¬±14.396     x2 heun2
9170.500 ms 9170.500 ms  ¬±0.000     x1 rk4
  86.940 ms   87.096 ms  ¬±0.060    x58 rk21
 407.699 ms  407.815 ms  ¬±0.065    x13 tsit54</samp></pre>
                        <p>We can once again see that the high-order adaptive methods are both more accurate and faster than the fixed-order ones.</p>
<h2>Further reading</h2>
<ul>
<li><a href="https://scinim.github.io/numericalnim/numericalnim/ode.html">numericalnim's documentation on ODEs</a></li>
</ul>
                        <script defer>/* Generated by the Nim Compiler v1.6.10 */
var framePtr = null;
var excHandler = 0;
var lastJSError = null;
if (!Math.trunc) {
  Math.trunc = function(v) {
    v = +v;
    if (!isFinite(v)) return v;
    return (v - v % 1) || (v < 0 ? -0 : v === 0 ? v : 0);
  };
}

var objectID_620757154 = [0];
</script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../numerical_methods/integration1d.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../numerical_methods/optimization.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../numerical_methods/integration1d.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../numerical_methods/optimization.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>







        <script src="../assets/js/clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../assets/js/highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../assets/js/book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
